/**
 * in_place_edit
 *
 * @version 20 February 2012
 */
(function(a){var b=function(b){var c,d={},e,f=a(this),g=a(this).find("form").filter(":first"),h=g.find(":input"),i,j,k;e={actions:[],addClassOnBlur:g.data("addClassOnBlur"),addClassOnFocus:g.data("addClassOnFocus"),addClassOnSubmit:g.data("addClassOnSubmit"),blurOnAutocompleteSelect:!1,blurOnSubmit:!1,disableInputsOnSubmit:!1,focusRespectiveInputs:!1,removeClassOnBlur:g.data("removeClassOnBlur"),removeClassOnFocus:g.data("removeClassOnFocus"),submitOnAutocompleteSelect:!1,submitOnBlur:!1,submitOnClick:!1,submitOnEnter:!1,toggleActionsOnMouseover:!1,showLabelOnBlur:!1,hideFormOnBlur:!1,showLabelOnEnter:!1,hideFormOnEnter:!1,showFormOnClick:!1,hideLabelOnClick:!1},e=a.extend(e,b),i=g.serializeArray(),d.submitOnBlur=function(){h.on({blur:function(){var a=function(){var a=g.serializeArray();JSON.stringify(i)!==JSON.stringify(a)&&g.trigger("submit")},b;b=setTimeout(a,100),g.data("timer",b)},focus:function(){var b={name:this.name,value:this.value};clearTimeout(g.data("timer")),a(i).each(function(a,c){c.name===b.name&&(i[a].value=b.value)})}})},d.submitOnClick=function(){g.find("input[type=checkbox]").on("click",function(){g.trigger("submit")})},d.submitOnEnter=function(){g.on({focus:function(){i=g.serializeArray()},keypress:function(a){var b=a.keyCode||a.which,c=null;b===13&&(a.preventDefault(),c=g.serializeArray(),JSON.stringify(i)!==JSON.stringify(c)&&g.trigger("submit"),i=c)}})},d.addClassOnFocus=function(){h.on({focus:function(){a(this).addClass(e.addClassOnFocus)}})},d.removeClassOnFocus=function(){h.on({focus:function(){a(this).removeClass(e.removeClassOnFocus)}})},d.addClassOnBlur=function(){h.on({blur:function(){a(this).addClass(e.addClassOnBlur)}})},d.removeClassOnBlur=function(){h.on({blur:function(){a(this).removeClass(e.removeClassOnBlur)}})},d.showFormOnClick=function(){f.find(".display_label").on("click",function(b){a(b.target).hasClass("no_toggle")||(a(this).parents(".display_label").hide(),g.show(),i=g.serializeArray())})},d.hideLabelOnClick=function(){f.find(".display_label").on("click",function(b){a(this).hide()})},d.showLabelOnBlur=function(){h.on({blur:function(){var a,b;a=function(){f.find(".display_label").show()},b=setTimeout(a,100),g.data("labelTimer",b)},focus:function(){clearTimeout(g.data("labelTimer"))}})},d.hideFormOnBlur=function(){h.on({blur:function(){var a,b;a=function(){g.hide()},b=setTimeout(a,100),g.data("labelTimer",b)},focus:function(){clearTimeout(g.data("labelTimer"))}})},d.showLabelOnEnter=function(){h.on({focus:function(){i=g.serializeArray()},keypress:function(a){var b=a.keyCode||a.which;b===13&&(a.preventDefault(),f.find(".display_label").show())}})},d.hideFormOnEnter=function(){h.on({keypress:function(a){var b=a.keyCode||a.which;b===13&&(a.preventDefault(),g.hide())}})},d.focusRespectiveInputs=function(){f.find(".display_label *").on("click",function(){var b=a(this);b.data("inPlaceFocusElement")?setTimeout(function(){f.find(b.data("inPlaceFocusElement")).trigger("focus")},10):f.find(":text:first, :text.initial_focus").trigger("focus")})},d.addClassOnSubmit=function(){var a=e.addClassOnSubmit;h.on({blur:function(){h.addClass(a)},keypress:function(b){var c=b.keyCode||b.which;c===13&&h.addClass(a)},submit:function(){h.addClass(a)}})},d.blurOnSubmit=function(){g.on("submit",function(){h.blur()})},d.blurOnAutocompleteSelect=function(){f.find(".ui-autocomplete-input").on("autocompleteselect",function(){a(this).blur()})},d.disableInputsOnSubmit=function(){g.on("submit",function(){h.prop("disabled",!0)})},d.toggleActionsOnMouseover=function(){f.find(".display_label").on({mouseover:function(){a(this).find(".controls").show()},mouseout:function(){a(this).find(".controls").hide()}})},d.submitOnAutocompleteSelect=function(){f.find(".ui-autocomplete-input").on({autocompleteselect:function(b,c){a(this).val(c.item.value),JSON.stringify(i)!==JSON.stringify(g.serializeArray())&&g.trigger("submit")},focus:function(){i=g.serializeArray()}})};if(e.actions.length===0&&f.data("inPlaceData")){e.actions=f.data("inPlaceData").split(" ");for(j=0,k=e.actions.length;j<k;j+=1)c=e.actions[j],e[c]=f.data(c)?f.data(c):!0}for(j=0,k=e.actions.length;j<k;j+=1){c=e.actions[j];if(e[c]){if(!d.hasOwnProperty(c))throw new Error("Option undefined:"+c);d[c].call(this)}}};a.fn.inPlaceEdit=function(a){return this.each(function(){b.call(this,a)})}})(jQuery);